/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-log.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-util.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-data.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-notifire.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-http.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-socket.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-unit.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-platform.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-file.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-game.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-view.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-hotUpdate.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};window.jees={};window.jees=jees||{};jees.log={TYPE_LOG:0,TYPE_WARN:1,TYPE_ERROR:2,_history:[],_push:function(a,b,c,d,f,k,n){var p=[];n?p=[c,d,f,k,n]:k?p=[c,d,f,k]:f?p=[c,d,f]:d?p=[c,d]:c&&(p=[c]);this._history.push({text:a,type:b,params:p});100<this._history.length&&this._history.shift()},_log:function(a,b,c,d,f,k){void 0!=k?console.log("CCC.Log:"+a,b,c,d,f,k):void 0!=f?console.log("CCC.Log:"+a,b,c,d,f):void 0!=d?console.log("CCC.Log:"+a,b,c,d):void 0!=c?console.log("CCC.Log:"+a,b,c):void 0!=b?console.log("CCC.Log:"+a,b):console.log("CCC.Log:"+a);this._push(a,this.TYPE_LOG,b,c,d,f,k)},_warn:function(a,b,c,d,f,k){void 0!=k?console.warn("CCC.Warn:"+a,b,c,d,f,k):void 0!=f?console.warn("CCC.Warn:"+a,b,c,d,f):void 0!=d?console.warn("CCC.Warn:"+a,b,c,d):void 0!=c?console.warn("CCC.Warn:"+a,b,c):void 0!=b?console.warn("CCC.Warn:"+a,b):console.warn("CCC.Warn:"+a);this._push(a,this.TYEP_WARN,b,c,d,f,k)},_err:function(a,b,c,d,f,k){void 0!=k?console.error("CCC.Err:"+a,b,c,d,f,k):void 0!=f?console.error("CCC.Err:"+a,b,c,d,f):void 0!=d?console.error("CCC.Err:"+a,b,c,d):void 0!=c?console.error("CCC.Err:"+a,b,c):void 0!=b?console.error("CCC.Err:"+a,b):console.error("CCC.Err:"+a);this._push(a,this.TYEP_ERROR,b,c,d,f,k)},log:function(a,b,c,d,f,k){this._log(a,b,c,d,f,k)},warn:function(a,b,c,d,f,k){this._warn(a,b,c,d,f,k)},err:function(a,b,c,d,f,k){this._err(a,b,c,d,f,k)}};window.log=function(a,b,c,d,f,k){jees.log.log(a,b,c,d,f,k)};window.err=function(a,b,c,d,f,k){jees.log.err(a,b,c,d,f,k)};window.warn=function(a,b,c,d,f,k){jees.log.warn(a,b,c,d,f,k)};window.jees=jees||{};jees.util={_seed:0,_units:null,_random_seed:function(){this._seed=(9301*this._seed+49297)%233280;return this._seed/233280},timestamp:function(){return(new Date).getTime()},random:function(a,b){0==this._seed&&(this._seed=this._random_seed(this.timestamp()));var c=b-a,d=Math.random(this._seed);return a+Math.round(c*d)},randomFloat:function(a,b){-1>a&&(a=-1);1<b&&(b=1);return this.random(100*a,100*b)/100},isInteger:function(a){return"number"==typeof a&&0==a%1},randomWeight:function(a){var b,c=0,d=!1;Math.gcd=function(a,c){var b=Math.min(a,c),d=Math.max(a,c),f=1;if(0===a||0===c)return d;for(var e=b;1<=e;e--)if(0===b%e&&0===d%e){f=e;break}return f};for(var f=[],k=0;k<a.length;k++)b=a[k].weight,"number"==typeof b?this.isInteger(b)?b=Math.floor(b):(b=Math.floor(100*b),d=!0):b=0,f[k]=b,c=Math.gcd(c,b);var k=[],n=b=0;if(d){for(c=0;c<a.length;c++)for(n=f[c],j=0;j<n&&!(100<=b);j++)k.push(c),b++;for(;100>b;)k.push(a.length-1),b++}else for(d=0;d<a.length;d++){for(var n=f[d]/c,p=0;p<n;p++)k.push(d);b+=n}return k[Math.floor(Math.random()*b)]},UNIT_BASE:["","","M","B","T"],UNIT_CHAT:"abcdefghijklmnopqrstuvwxyz".split(""),decimal2string:function(a){a instanceof Decimal||(a=new Decimal(a));var b=a.isNeg();b&&(a=a.abs());var c=a;a=c.e;var d=a/3;0!=a%3&&(d=Math.floor((a-1)/3),a=3*d,0>a&&(a=0));0>d&&(d=0);if(15>a)a=this.UNIT_BASE[d];else{var f=Math.floor((a-15)/3);a="";if(26>f)a=this.UNIT_CHAT[0]+this.UNIT_CHAT[f];else for(;0<f;){var k=f%26,f=Math.floor(f/26);a=this.UNIT_CHAT[k]+a}}if(c.lt(1E3)){c=c.toFixed(3).toString();if(-1!=c.indexOf("."))for(;"0"==c.charAt(c.length-1);)c=c.slice(0,c.length-1);"."==c.charAt(c.length-1)&&(c=c.slice(0,c.length-1))}else if(c.lt(1E6))c=c.toDP(0).toString(),d=c.length-3,c=c.slice(0,d)+","+c.slice(d);else{c=c.div(Decimal.pow(1E3,d)).toFixed(3).toString();if(-1!=c.indexOf("."))for(;"0"==c.charAt(c.length-1);)c=c.slice(0,c.length-1);"."==c.charAt(c.length-1)&&(c=c.slice(0,c.length-1))}return(b?"-":"")+c+a},string2decimal:function(a){if(a instanceof Decimal)return a;a=""+a;if("number"==typeof a||-1==a.indexOf("|"))return a=new Decimal(a);a=a.split("|");var b=0,c=parseFloat(a[0]);if(null==this._units){this._units=new Map;for(var d=C.all("GameUnit"),d=$jscomp.makeIterator(d),f=d.next();!f.done;f=d.next())f=f.value,this._units.set(f[1].unit,f[0])}this._units.has(a[1])&&(b=this._units.get(a[1]));return a=Decimal.pow(10,b).times(c)},loadjs:function(a){var b=document.getElementsByTagName("head").item(0),c=document.createElement("script");c.src=a;c.type="text/javascript";c.defer=!0;b.appendChild(c)},time2cd:function(a,b){var c=parseInt((a+900)/1E3),d=parseInt(c/60),f=parseInt(d/60),c=c%60,d=d%60;0>c&&(c=0);10>c&&(c="0"+c);10>d&&(d="0"+d);10>f&&(f="0"+f);return b?b.replace("hh",f).replace("mm",d).replace("ss",c):f+":"+d+":"+c}};jees.md5=function(a){function b(a,c){return a[c+3]<<24|a[c+2]<<16|a[c+1]<<8|a[c]}if(!a instanceof Uint8Array){try{log("input data type mismatch only support Uint8Array")}catch(q){}return null}for(var c=[],d=0;d<a.byteLength;d++)c.push(a[d]);a=c.length;c.push(128);var f=c.length%64;if(56<f){for(d=0;d<64-f;d++)c.push(0);f=c.length%64}for(d=0;d<56-f;d++)c.push(0);c=c.concat(function(a){for(var c=[],b=0;8>b;b++)c.push(a&255),a>>>=8;return c}(8*a));a=1732584193;for(var f=4023233417,k=2562383102,n=271733878,p=0,e=0,h=0,g=0,l=function(a,c,b,d){var f=g;g=h;var k=h=e;a=4294967295&p+(4294967295&a+(4294967295&c+b));e=4294967295&k+(a<<d&4294967295|a>>>32-d);p=f},d=0;d<c.length/64;d++){var p=a,e=f,h=k,g=n,m=64*d;l(e&h|~e&g,3614090360,b(c,m),7);l(e&h|~e&g,3905402710,b(c,m+4),12);l(e&h|~e&g,606105819,b(c,m+8),17);l(e&h|~e&g,3250441966,b(c,m+12),22);l(e&h|~e&g,4118548399,b(c,m+16),7);l(e&h|~e&g,1200080426,b(c,m+20),12);l(e&h|~e&g,2821735955,b(c,m+24),17);l(e&h|~e&g,4249261313,b(c,m+28),22);l(e&h|~e&g,1770035416,b(c,m+32),7);l(e&h|~e&g,2336552879,b(c,m+36),12);l(e&h|~e&g,4294925233,b(c,m+40),17);l(e&h|~e&g,2304563134,b(c,m+44),22);l(e&h|~e&g,1804603682,b(c,m+48),7);l(e&h|~e&g,4254626195,b(c,m+52),12);l(e&h|~e&g,2792965006,b(c,m+56),17);l(e&h|~e&g,1236535329,b(c,m+60),22);l(g&e|~g&h,4129170786,b(c,m+4),5);l(g&e|~g&h,3225465664,b(c,m+24),9);l(g&e|~g&h,643717713,b(c,m+44),14);l(g&e|~g&h,3921069994,b(c,m),20);l(g&e|~g&h,3593408605,b(c,m+20),5);l(g&e|~g&h,38016083,b(c,m+40),9);l(g&e|~g&h,3634488961,b(c,m+60),14);l(g&e|~g&h,3889429448,b(c,m+16),20);l(g&e|~g&h,568446438,b(c,m+36),5);l(g&e|~g&h,3275163606,b(c,m+56),9);l(g&e|~g&h,4107603335,b(c,m+12),14);l(g&e|~g&h,1163531501,b(c,m+32),20);l(g&e|~g&h,2850285829,b(c,m+52),5);l(g&e|~g&h,4243563512,b(c,m+8),9);l(g&e|~g&h,1735328473,b(c,m+28),14);l(g&e|~g&h,2368359562,b(c,m+48),20);l(e^h^g,4294588738,b(c,m+20),4);l(e^h^g,2272392833,b(c,m+32),11);l(e^h^g,1839030562,b(c,m+44),16);l(e^h^g,4259657740,b(c,m+56),23);l(e^h^g,2763975236,b(c,m+4),4);l(e^h^g,1272893353,b(c,m+16),11);l(e^h^g,4139469664,b(c,m+28),16);l(e^h^g,3200236656,b(c,m+40),23);l(e^h^g,681279174,b(c,m+52),4);l(e^h^g,3936430074,b(c,m),11);l(e^h^g,3572445317,b(c,m+12),16);l(e^h^g,76029189,b(c,m+24),23);l(e^h^g,3654602809,b(c,m+36),4);l(e^h^g,3873151461,b(c,m+48),11);l(e^h^g,530742520,b(c,m+60),16);l(e^h^g,3299628645,b(c,m+8),23);l(h^(e|~g),4096336452,b(c,m),6);l(h^(e|~g),1126891415,b(c,m+28),10);l(h^(e|~g),2878612391,b(c,m+56),15);l(h^(e|~g),4237533241,b(c,m+20),21);l(h^(e|~g),1700485571,b(c,m+48),6);l(h^(e|~g),2399980690,b(c,m+12),10);l(h^(e|~g),4293915773,b(c,m+40),15);l(h^(e|~g),2240044497,b(c,m+4),21);l(h^(e|~g),1873313359,b(c,m+32),6);l(h^(e|~g),4264355552,b(c,m+60),10);l(h^(e|~g),2734768916,b(c,m+24),15);l(h^(e|~g),1309151649,b(c,m+52),21);l(h^(e|~g),4149444226,b(c,m+16),6);l(h^(e|~g),3174756917,b(c,m+44),10);l(h^(e|~g),718787259,b(c,m+8),15);l(h^(e|~g),3951481745,b(c,m+36),21);a=4294967295&a+p;f=4294967295&f+e;k=4294967295&k+h;n=4294967295&n+g}return function(a,c,b,d){for(var f="",e,g,h=3;0<=h;h--)g=arguments[h],e=g&255,g>>>=8,e<<=8,e|=g&255,g>>>=8,e<<=8,e|=g&255,g>>>=8,e<<=8,g=e|=g,e=(g>>>24).toString(16),g=(g&16777215).toString(16),e="00".substr(0,2-e.length)+e+"000000".substr(0,6-g.length)+g,f+=e;return f}(n,k,f,a).toLowerCase()};window.md5=function(a){return jees.md5(a)};window.jees=jees||{};jees.data={_local:null,_objs:new Map,init:function(){this._inited||(this._inited=!0,this._local=jees.platform.localStorage())},regist:function(a,b){this._objs.set(a,b)},set:function(a,b){this._local.setItem(a,b)},get:function(a){return this._local.getItem(a)},get2:function(a,b){var c=this.get(a);return c?b=this.json2data(JSON.parse(c),b):null},set2:function(a,b){for(var c in b)c.startsWith("_")&&delete b[c];this.set(a,JSON.stringify(b))},del:function(a){return this._local.removeItem(a)},json2data:function(a,b){for(var c in b)if(a.hasOwnProperty(c))if(b[c]instanceof Date)b[c]=new Date(a[c]);else{var d=null;if(b[c]instanceof Object)for(var f=$jscomp.makeIterator(this._objs),k=f.next();!k.done;k=f.next())if(k=k.value,b[c]instanceof k[0]){d=k[1].build();break}d?b[c]=this.json2data(a[c],d):c.startsWith("_")||(b[c]=a[c])}return b},eachLoad:function(a,b){if(!jees.data.get(a))return[];for(var c=JSON.parse(jees.data.get(a)),d=c.length,f=0;f<d;f++){var k=c[f];b&&(c[f]=b(k))}return c}};window.jees=jees||{};jees.notifire={_events:new Map,bind:function(a,b,c){a._evt_funs||(a._evt_funs=new Map);c&&a._evt_funs.set(b,c);(c=this._events.get(b))?c.add(a):(c=new Set,c.add(a),this._events.set(b,c))},unbind:function(a,b){if(b)a._evt_funs.has(b)&&a._evt_funs["delete"](b);else{var c=this._events.get(b);c&&c["delete"](a);a._evt_funs=null}},notify:function(a,b,c,d,f,k){var n=this._events.get(a);if(n)for(var n=$jscomp.makeIterator(n.keys()),p=n.next();!p.done;p=n.next()){var p=p.value,e=!0;if(p._evt_funs){var h=p._evt_funs.get(a);h&&(h(a,b,c,d,f,k),e=!1)}e&&p.notify&&p.notify(a,b,c,d,f,k)}}};window.notify=function(a,b,c,d,f,k){jees.notifire.notify(a,b,c,d,f,k)};window.jees=jees||{};jees.http={_requester:null,init:function(){this._inited||(this._inited=!0)},_callset:function(a){var b=this._requester;b.onreadystatechange=function(){if(4===b.readyState&&200==b.status){var c=b.responseText;log("\u8fd4\u56de\u5185\u5bb9: ",c);a&&a(c)}else 4===b.readyState&&401==b.status&&err("401\u9519\u8bef.")};b.timeout=5E3},_get:function(a,b){var c=this._requester=jees.platform.request();c.open("GET",a,!0);this._callset(b);c.send()},_post:function(a,b,c){var d=this._requester=jees.platform.request();d.open("POST",a,!0);this._callset(c);d.send(JSON.stringify(b))},get:function(a,b){this._get(a,b)},post:function(a,b,c){this._post(a,b,c)}};window.jees=jees||{};jees.socket={_remote_config:"http://127.0.0.1/socket.json",init:function(){var a=this;if(!this._inited){this._inited=!0;var b=this._remote_config;b.startsWith("http")?jees.http.get(b,function(c){a._servers=JSON.parse(c).servers;jees.game.frame(function(){a.connect()})}):jees.file.json(b,function(c){a._servers=c.servers;jees.game.frame(function(){a.connect()})})}},connect:function(){console.log("\u670d\u52a1\u5668\u914d\u7f6e: ",this._servers)},request:function(){}};window.jees=jees||{};jees.unit={byte2kb:function(a,b){return(a/1024).toFixed(b||2)+"KB"},byte2mb:function(a,b){return(a/1048576).toFixed(b||2)+"MB"},byte2gb:function(a,b){return(a/1073741824).toFixed(b||2)+"GB"},byte2:function(a,b){var c=a/1024,d="KB";100<c&&(c/=1024,d="MB");100<c&&(c/=1024,d="GB");return c.toFixed(b||2)+d}};window.jees=jees||{};jees.platform={isNative:function(){return cc.sys.isNative},isAndroid:function(){return cc.sys.os===cc.sys.OS_ANDROID},request:function(){return cc.loader.getXMLHttpRequest()},localStorage:function(){return cc.sys.localStorage},locale:function(){return cc.sys.languageCode}};window.jees=jees||{};jees.file={load:function(a,b,c){cc.loader.loadRes(a,function(a,f){a?(err("\u52a0\u8f7d\u6587\u4ef6\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(a)),c&&c(a)):b&&b(f)})},loadRemote:function(a,b,c){cc.loader.load(a,function(d,f){d?(err("\u52a0\u8f7d\u6587\u4ef6["+a+"]\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(d)),c&&c(d)):b&&b(f)})},files:function(a,b,c){cc.loader.loadResDir(a,function(a,f){a?(err("\u52a0\u8f7d\u6587\u4ef6\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(a)),c&&c(a)):b&&b(f)})},filesBy:function(a,b,c,d){cc.loader.loadResDir(a,b,function(a,b){a?(err("\u52a0\u8f7d\u6587\u4ef6\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(a)),d&&d(a)):c&&c(b)})},json:function(a,b,c){cc.loader.loadRes(a,function(d,f){d?(err("\u52a0\u8f7d\u6587\u4ef6["+a+"]\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(d)),c&&c(d)):b&&b(f.json)})},file:function(a){return cc.url.raw(a)},text:function(a){return jsb&&jsb.fileUtils&&jsb.fileUtils.getStringFromFile(a)},remove:function(a){log("\u5220\u9664\u6587\u4ef6: "+a);jsb&&jsb.fileUtils&&jsb.fileUtils.isFileExist(a)&&jsb.fileUtils.removeFile(a)},removeDir:function(a){log("\u5220\u9664\u76ee\u5f55: "+a);jsb&&jsb.fileUtils&&jsb.fileUtils.isDirectoryExist(a)&&jsb.fileUtils.removeDirectory(a)}};window.jees=jees||{};jees.game={_fires:["Start","Update","Game"],_fireIdx:0,_frame:[],_ticks:[],_time:0,_option:{fires:["Start","Update","Game"]},init:function(a){if(!this._inited){this._inited=!0;if(a)for(var b in a)this._option.hasOwnProperty(b)&&(this._option[b]=a[b]);this._time=jees.util.timestamp();jees.data.init();jees.http.init();jees.socket.init()}},enter:function(){var a=this._option,b=a.fires[this._fireIdx];this._fireIdx>=a.length||(this._fireIdx++,log("\u5207\u6362\u754c\u9762: ",b),cc.director.loadScene(b))},leave:function(){},frame:function(a){a&&this._frame.push(a)},tick:function(a){a&&this._ticks.push(a)},removeTick:function(a){for(var b=this._ticks.length,c=0;c<b;c++)if(this._ticks[c]===a){this._ticks.splice(c,1);break}},update:function(a){var b=this._frame.shift();b&&b(a);for(var b=this._ticks.length,c=0;c<b;c++)(0,this._ticks[c])(a)},time:function(){return 0==this._time?jees.util.timestamp():this._time},timeplus:function(){0!=this._time&&(this._time+=1E3)}};window.jees=jees||{};jees.view={init:function(a){this._inited||(this._inited=!0)}};jees.view.Comp=cc.Class({"extends":cc.Component,onLoad:function(){this._ex_load&&this._ex_load()},start:function(){this._ex_start&&this._ex_start()},update:function(a){this._ex_update&&this._ex_update(a)},onEnable:function(){this._ex_enable&&this._ex_enable()},onDisable:function(){this._ex_disable&&this._ex_disable()},onDestroy:function(){this.unbind();this._ex_destroy&&this._ex_destroy()},bind:function(a,b){jees.notifire.bind(this,a,b)},unbind:function(a){jees.notifire.unbind(this,a)},notify:function(a,b,c,d,f,k){this._ex_notify&&this._ex_notify(a,b,c,d,f,k)},click:function(a,b){a.on(cc.Node.EventType.TOUCH_END,function(){b&&b()})}});jees.view.Fire=cc.Class({"extends":jees.view.Comp,properties:{nodeHead:cc.Node,nodeBody:cc.Node,viewBody:cc.Prefab,nodeWind:cc.Node},onLoad:function(){jees.view.init(this);if(this.nodeBody&&this.viewBody){var a=cc.instantiate(this.viewBody);this.nodeBody.addChild(a)}this._ex_load&&this._ex_load();this._windows=new Map},start:function(){var a=this;this._ex_start&&this._ex_start();this.schedule(function(){a.second()},1)},update:function(a){jees.game.update(a);this._ex_update&&this._ex_update(a)},openWindow:function(a,b,c,d,f,k){var n=this;this.nodeWind&&jees.file.load("views/window/"+a,function(a){a=cc.instantiate(a);a.getComponent(jees.view.Window).setParams(b,c,d,f,k);n.nodeWind.addChild(a)})},second:function(){jees.game.timeplus();this._ex_second&&this._ex_second()}});jees.view.Body=cc.Class({"extends":jees.view.Comp});window.ShowType=cc.Enum({NONE:-1,SCALE:-1});jees.view.Window=cc.Class({"extends":jees.view.Comp,properties:{nodeClose:cc.Node,nodeBody:cc.Node,ShowType:{"default":ShowType.NONE,type:ShowType,tooltip:CC_DEV&&"\u663e\u793a\u6548\u679c"},HideType:{"default":ShowType.NONE,type:ShowType,tooltip:CC_DEV&&"\u9690\u85cf\u6548\u679c"}},onLoad:function(){var a=this;this.nodeClose&&this.click(this.nodeClose,function(){a._hide()});this._ex_load&&this._ex_load()},start:function(){this._show();this._ex_start&&this._ex_start()},setParams:function(a,b,c,d,f){this._params=[a,b,c,d,f]},_show:function(){switch(this.ShowType){case ShowType.SCALE:this._scale_show();break;default:this._on_show()}},_hide:function(){switch(this.HideType){case ShowType.SCALE:this._scale_hide();break;default:this._on_hide()}},_get_node:function(){return this.nodeBody||this.node},_on_show:function(){this.node.active=!0},_on_hide:function(){this.node.active=!1;this.node.destroy()},_scale_show:function(){var a=this,b=this._get_node();cc.tween(b).to(0,{scale:.1}).to(.2,{scale:1.2}).to(.1,{scale:1}).call(function(){a._on_show()}).start()},_scale_hide:function(){var a=this,b=this._get_node();cc.tween(b).to(.1,{scale:1.2}).to(.2,{scale:.1}).call(function(){a._on_hide()}).start()}});window.jees=jees||{};window.HotUpdateEvent=function(a){this._code=a||jees.hotUpdate.UPDATE_FAILED;this.getEventCode=function(){return this._code}};jees.hotUpdate={ANDROID_MAX_CONNECT:2,_status:0,STATUS_NONE:0,STATUS_UPDATING:1,STATUS_FINISH:2,STATUS_ISNEW:3,STATUS_FAILED:-1,ERROR_NO_LOCAL_MANIFEST:0,ERROR_DOWNLOAD_MANIFEST:1,ERROR_PARSE_MANIFEST:2,NEW_VERSION_FOUND:3,ALREADY_UP_TO_DATE:4,UPDATE_PROGRESSION:5,ASSET_UPDATED:6,ERROR_UPDATING:7,UPDATE_FINISHED:8,UPDATE_FAILED:9,ERROR_DECOMPRESS:10,_current_version:"1.0.0",_remote_manifest:"http://127.0.0.1/ccc/project.manifest",_update_dir:"remote-assets",_manifest_name:"project.manifest",_manifest_file:null,_compare:function(a,b){log("\u6bd4\u8f83\u7248\u672c: "+a+", \u8fdc\u7a0b\u7248\u672c: "+b);for(var c=a.split("."),d=b.split("."),f=0;f<c.length;++f){var k=parseInt(c[f]),n=parseInt(d[f]||0);if(k!==n)return k-n}return d.length>c.length?-1:0},_verify:function(a,b){b.compressed||md5(jsb.fileUtils.getDataFromFile(a));return!0},_callback:function(a){var b=a.getEventCode();log("\u66f4\u65b0\u72b6\u6001: "+this.code(b));switch(b){case this.UPDATE_PROGRESSION:case this.ASSET_UPDATED:break;case this.NEW_VERSION_FOUND:this._status==this.STATUS_NONE&&(this._status=this.STATUS_UPDATING,this._am.update());break;case this.ALREADY_UP_TO_DATE:this._status==this.STATUS_NONE&&(this._status=this.STATUS_ISNEW,this._am.setEventCallback(null));break;case this.UPDATE_FINISHED:this._status==this.STATUS_UPDATING&&(this._status=this.STATUS_FINISH,this._save(),this._am.setEventCallback(null));break;default:this._status=this.STATUS_FAILED;this._am.setEventCallback(null);return}this._handler&&this._handler(this._status,a)},_save:function(){log("\u66f4\u65b0\u5b8c\u6210, \u4fdd\u5b58\u66f4\u65b0\u4fe1\u606f.");var a=jsb.fileUtils.getSearchPaths(),b=this._am.getLocalManifest().getSearchPaths();log("\u65b0\u7684\u641c\u7d22\u8def\u5f84: "+JSON.stringify(b));Array.prototype.unshift(a,b);a=JSON.stringify(a);log("\u6700\u7ec8\u641c\u7d22\u8def\u5f84: "+a);jees.data.set("HotUpdateSearchPaths",a);jsb.fileUtils.setSearchPaths(a)},code:function(a){var b="\u72b6\u6001\u7801["+a+"]: ";switch(a){case this.ERROR_NO_LOCAL_MANIFEST:b="\u672c\u5730Manifest\u6587\u4ef6\u6ca1\u6709\u627e\u5230!";break;case this.ERROR_DOWNLOAD_MANIFEST:b="\u8fdc\u7a0bManifest\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25!";break;case this.ERROR_PARSE_MANIFEST:b="\u8fdc\u7a0bManifest\u6587\u4ef6\u89e3\u6790\u5931\u8d25!";break;case this.NEW_VERSION_FOUND:b="\u53d1\u73b0\u65b0\u7684\u7248\u672c.";break;case this.ALREADY_UP_TO_DATE:b="\u5f53\u524d\u5df2\u7ecf\u662f\u6700\u65b0\u7248\u672c\u4e86.";break;case this.UPDATE_PROGRESSION:b="\u6b63\u5728\u66f4\u65b0\u4e2d...";break;case this.UPDATE_FINISHED:b="\u66f4\u65b0\u6210\u529f.";break;case this.UPDATE_FAILED:b="\u66f4\u65b0\u5931\u8d25!";break;case this.ERROR_UPDATING:b="\u66f4\u65b0\u53d1\u751f\u9519\u8bef!";break;case this.ERROR_DECOMPRESS:b="\u89e3\u538b\u53d1\u751f\u9519\u8bef!";break;case this.ASSET_UPDATED:b="\u8d44\u6e90\u5df2\u66f4\u65b0."}return b},version:function(){return this._current_version},bind:function(a){this._handler=a||null},check:function(a){var b=this;a&&(this._remote_manifest=a);log("\u68c0\u67e5\u66f4\u65b0...");if(jees.platform.isNative()){this._update_dir=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+this._update_dir;this._manifest_file=this._update_dir+"/"+this._manifest_name;a="";if(jsb.fileUtils.isFileExist(this._manifest_file))log("\u4f7f\u7528\u672c\u5730\u5df2\u5b58\u50a8Manifest: "+this._manifest_file);else{log("\u7b2c\u4e00\u6b21\u66f4\u65b0...");log("\u4f7f\u7528Manifest: "+this._remote_manifest);if(this._remote_manifest.startsWith("http")){jees.http.get(this._remote_manifest,function(a){log("\u670d\u52a1\u5668\u8fd4\u56de2: ",a);a=JSON.parse(a);a.version=b._current_version;a.assets=[];a.searchPaths=[];a=JSON.stringify(a);log("Manifest\u5185\u5bb9: "+a);b._manifest_file=new jsb.Manifest(a,b._update_dir);jees.game.frame(function(){b.starting()})});return}this._manifest_file=jees.file.file(this._remote_manifest)}a=jees.file.text(this._manifest_file);log("Manifest\u5185\u5bb9: "+a);this._current_version=JSON.parse(a).version;this.starting()}else log("\u65e0\u6cd5\u4f7f\u7528\u5728\u7ebf\u66f4\u65b0"),this._handler&&this._handler(this.STATUS_FAILED,new HotUpdateEvent)},starting:function(){log("\u5f00\u59cb\u66f4\u65b0...");this._am=new jsb.AssetsManager(this._manifest_file,this._update_dir);this._am.setVerifyCallback(this._verify);this._am.setVersionCompareHandle(this._compare);this._am.setEventCallback(this._callback.bind(this));jees.platform.isAndroid()&&(this._am.setMaxConcurrentTask(this.ANDROID_MAX_CONNECT),log("\u8bbe\u7f6e\u5b89\u5353\u8bbe\u5907\u540c\u65f6\u6700\u5927\u4e0b\u8f7d\u6570\uff1a"+this.ANDROID_MAX_CONNECT));this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this._manifest_file,this._update_dir);var a=this._am.getLocalManifest(),b=a&&a.isLoaded();b?this._am.checkUpdate():(log("Manifest\u6587\u4ef6\u65e0\u6548\u6216\u8005\u52a0\u8f7d\u5931\u8d25."+JSON.stringify(a)+"-\x3e"+b),this._handler&&this._handler(this.STATUS_FAILED,new HotUpdateEvent(this.ERROR_DOWNLOAD_MANIFEST)))},retry:function(){log("\u91cd\u65b0\u4e0b\u8f7d\u8d44\u6e90...");this._am.downloadFailedAssets()}};