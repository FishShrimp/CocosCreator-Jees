/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-log.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-md5.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-data.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-notifire.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-http.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-socket.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/jees-unit.js
 * License: MIT license
 */

/**
 * @module Jees
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-platform.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-file.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-game.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-view.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
/*
 * Author: Aiyoyoyo https://github.com/aiyoyoyo/CocosCreator-Jees/blob/master/src/cc/jees-hotUpdate.js
 * License: MIT license
 */

/**
 * @module Jees
 * @template CocosCreator 仅适用CocosCreator
 */
// namespace:
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};window.jees={};window.jees=jees||{};jees.log={TYPE_LOG:0,TYPE_WARN:1,TYPE_ERROR:2,_history:[],_push:function(a,b,c,g,l,m,p){var n=[];p?n=[c,g,l,m,p]:m?n=[c,g,l,m]:l?n=[c,g,l]:g?n=[c,g]:c&&(n=[c]);this._history.push({text:a,type:b,params:n});100<this._history.length&&this._history.shift()},_log:function(a,b,c,g,l,m){m?console.log("CCC.Log:"+a,b,c,g,l,m):l?console.log("CCC.Log:"+a,b,c,g,l):g?console.log("CCC.Log:"+a,b,c,g):c?console.log("CCC.Log:"+a,b,c):b?console.log("CCC.Log:"+a,b):console.log("CCC.Log:"+a);this._push(a,this.TYPE_LOG,b,c,g,l,m)},_warn:function(a,b,c,g,l,m){m?console.warn("CCC.Warn:"+a,b,c,g,l,m):l?console.warn("CCC.Warn:"+a,b,c,g,l):g?console.warn("CCC.Warn:"+a,b,c,g):c?console.warn("CCC.Warn:"+a,b,c):b?console.warn("CCC.Warn:"+a,b):console.warn("CCC.Warn:"+a);this._push(a,this.TYEP_WARN,b,c,g,l,m)},_err:function(a,b,c,g,l,m){m?console.error("CCC.Err:"+a,b,c,g,l,m):l?console.error("CCC.Err:"+a,b,c,g,l):g?console.error("CCC.Err:"+a,b,c,g):c?console.error("CCC.Err:"+a,b,c):b?console.error("CCC.Err:"+a,b):console.error("CCC.Err:"+a);this._push(a,this.TYEP_ERROR,b,c,g,l,m)},log:function(a,b,c,g,l,m){this._log(a,b,c,g,l,m)},warn:function(a,b,c,g,l,m){this._warn(a,b,c,g,l,m)},err:function(a,b,c,g,l,m){this._err(a,b,c,g,l,m)}};window.log=function(a,b,c,g,l,m){jees.log.log(a,b,c,g,l,m)};window.err=function(a,b,c,g,l,m){jees.log.err(a,b,c,g,l,m)};window.warn=function(){jees.log.warn(_txt,_p0,_p1,_p2,_p3,_p4)};window.jees=jees||{};jees.md5=function(a){function b(b,a){return b[a+3]<<24|b[a+2]<<16|b[a+1]<<8|b[a]}if(!a instanceof Uint8Array){try{log("input data type mismatch only support Uint8Array")}catch(q){}return null}for(var c=[],g=0;g<a.byteLength;g++)c.push(a[g]);a=c.length;c.push(128);var l=c.length%64;if(56<l){for(g=0;g<64-l;g++)c.push(0);l=c.length%64}for(g=0;g<56-l;g++)c.push(0);c=c.concat(function(b){for(var a=[],c=0;8>c;c++)a.push(b&255),b>>>=8;return a}(8*a));a=1732584193;for(var l=4023233417,m=2562383102,p=271733878,n=0,e=0,f=0,d=0,h=function(b,a,c,g){var h=d;d=f;var k=f=e;b=4294967295&n+(4294967295&b+(4294967295&a+c));e=4294967295&k+(b<<g&4294967295|b>>>32-g);n=h},g=0;g<c.length/64;g++){var n=a,e=l,f=m,d=p,k=64*g;h(e&f|~e&d,3614090360,b(c,k),7);h(e&f|~e&d,3905402710,b(c,k+4),12);h(e&f|~e&d,606105819,b(c,k+8),17);h(e&f|~e&d,3250441966,b(c,k+12),22);h(e&f|~e&d,4118548399,b(c,k+16),7);h(e&f|~e&d,1200080426,b(c,k+20),12);h(e&f|~e&d,2821735955,b(c,k+24),17);h(e&f|~e&d,4249261313,b(c,k+28),22);h(e&f|~e&d,1770035416,b(c,k+32),7);h(e&f|~e&d,2336552879,b(c,k+36),12);h(e&f|~e&d,4294925233,b(c,k+40),17);h(e&f|~e&d,2304563134,b(c,k+44),22);h(e&f|~e&d,1804603682,b(c,k+48),7);h(e&f|~e&d,4254626195,b(c,k+52),12);h(e&f|~e&d,2792965006,b(c,k+56),17);h(e&f|~e&d,1236535329,b(c,k+60),22);h(d&e|~d&f,4129170786,b(c,k+4),5);h(d&e|~d&f,3225465664,b(c,k+24),9);h(d&e|~d&f,643717713,b(c,k+44),14);h(d&e|~d&f,3921069994,b(c,k),20);h(d&e|~d&f,3593408605,b(c,k+20),5);h(d&e|~d&f,38016083,b(c,k+40),9);h(d&e|~d&f,3634488961,b(c,k+60),14);h(d&e|~d&f,3889429448,b(c,k+16),20);h(d&e|~d&f,568446438,b(c,k+36),5);h(d&e|~d&f,3275163606,b(c,k+56),9);h(d&e|~d&f,4107603335,b(c,k+12),14);h(d&e|~d&f,1163531501,b(c,k+32),20);h(d&e|~d&f,2850285829,b(c,k+52),5);h(d&e|~d&f,4243563512,b(c,k+8),9);h(d&e|~d&f,1735328473,b(c,k+28),14);h(d&e|~d&f,2368359562,b(c,k+48),20);h(e^f^d,4294588738,b(c,k+20),4);h(e^f^d,2272392833,b(c,k+32),11);h(e^f^d,1839030562,b(c,k+44),16);h(e^f^d,4259657740,b(c,k+56),23);h(e^f^d,2763975236,b(c,k+4),4);h(e^f^d,1272893353,b(c,k+16),11);h(e^f^d,4139469664,b(c,k+28),16);h(e^f^d,3200236656,b(c,k+40),23);h(e^f^d,681279174,b(c,k+52),4);h(e^f^d,3936430074,b(c,k),11);h(e^f^d,3572445317,b(c,k+12),16);h(e^f^d,76029189,b(c,k+24),23);h(e^f^d,3654602809,b(c,k+36),4);h(e^f^d,3873151461,b(c,k+48),11);h(e^f^d,530742520,b(c,k+60),16);h(e^f^d,3299628645,b(c,k+8),23);h(f^(e|~d),4096336452,b(c,k),6);h(f^(e|~d),1126891415,b(c,k+28),10);h(f^(e|~d),2878612391,b(c,k+56),15);h(f^(e|~d),4237533241,b(c,k+20),21);h(f^(e|~d),1700485571,b(c,k+48),6);h(f^(e|~d),2399980690,b(c,k+12),10);h(f^(e|~d),4293915773,b(c,k+40),15);h(f^(e|~d),2240044497,b(c,k+4),21);h(f^(e|~d),1873313359,b(c,k+32),6);h(f^(e|~d),4264355552,b(c,k+60),10);h(f^(e|~d),2734768916,b(c,k+24),15);h(f^(e|~d),1309151649,b(c,k+52),21);h(f^(e|~d),4149444226,b(c,k+16),6);h(f^(e|~d),3174756917,b(c,k+44),10);h(f^(e|~d),718787259,b(c,k+8),15);h(f^(e|~d),3951481745,b(c,k+36),21);a=4294967295&a+n;l=4294967295&l+e;m=4294967295&m+f;p=4294967295&p+d}return function(b,a,c,e){for(var g="",d,f,h=3;0<=h;h--)f=arguments[h],d=f&255,f>>>=8,d<<=8,d|=f&255,f>>>=8,d<<=8,d|=f&255,f>>>=8,d<<=8,f=d|=f,d=(f>>>24).toString(16),f=(f&16777215).toString(16),d="00".substr(0,2-d.length)+d+"000000".substr(0,6-f.length)+f,g+=d;return g}(p,m,l,a).toLowerCase()};window.md5=function(a){return jees.md5(a)};window.jees=jees||{};jees.data={_local:null,init:function(){this._inited||(this._inited=!0,this._local=jees.platform.localStorage())},set:function(a,b){this._local.setItem(a,b)},get:function(a){return this._local.getItem(a)},get2:function(a,b){var c=this.get(a);if(c){var c=JSON.parse(c),g;for(g in b)c.hasOwnProperty(g)&&(b[g]instanceof Date?b[g]=new Date(c[g]):g.startsWith("_")||(b[g]=c[g]));return b}return null},set2:function(a,b){for(var c in b)c.startsWith("_")&&delete b[c];this.set(a,JSON.stringify(b))},del:function(a){return this._local.removeItem(a)}};window.jees=jees||{};jees.notifire={_events:new Map,bind:function(a,b,c){a._evt_funs||(a._evt_funs=new Map);c&&a._evt_funs.set(b,c);(c=this._events.get(b))?c.add(a):(c=new Set,c.add(a),this._events.set(b,c))},unbind:function(a,b){if(b)a._evt_funs.has(b)&&a._evt_funs["delete"](b);else{var c=this._events.get(b);c&&c["delete"](a);a._evt_funs=null}},notify:function(a,b,c,g,l,m){for(var p=this._events.get(a),p=$jscomp.makeIterator(p.keys()),n=p.next();!n.done;n=p.next()){var n=n.value,e=!0;if(n._evt_funs){var f=n._evt_funs.get(a);f&&(f(a,b,c,g,l,m),e=!1)}e&&n.notify&&n.notify(a,b,c,g,l,m)}}};window.notify=function(a){jees.notifire.notify(a)};window.jees=jees||{};jees.http={_requester:null,init:function(){this._inited||(this._inited=!0)},_callset:function(a){var b=this._requester;b.onreadystatechange=function(){if(4===b.readyState&&200==b.status){var c=b.responseText;log("\u8fd4\u56de\u5185\u5bb9: ",c);a&&a(c)}else 4===b.readyState&&401==b.status&&err("401\u9519\u8bef.")};b.timeout=5E3},_get:function(a,b){var c=this._requester=jees.platform.request();c.open("GET",a,!0);this._callset(b);c.send()},_post:function(a,b,c){var g=this._requester=jees.platform.request();g.open("POST",a,!0);this._callset(c);g.send(JSON.stringify(b))},get:function(a,b){this._get(a,b)},post:function(a,b,c){this._post(a,b,c)}};window.jees=jees||{};jees.socket={_remote_config:"http://127.0.0.1/socket.json",init:function(){var a=this;if(!this._inited){this._inited=!0;var b=this._remote_config;b.startsWith("http")?jees.http.get(b,function(b){a._servers=JSON.parse(b).servers;jees.game.frame(function(){a.connect()})}):jees.file.json(b,function(b){a._servers=b.servers;jees.game.frame(function(){a.connect()})})}},connect:function(){console.log("\u670d\u52a1\u5668\u914d\u7f6e: ",this._servers)},request:function(){}};window.jees=jees||{};jees.unit={byte2kb:function(a,b){return(a/1024).toFixed(b||2)+"KB"},byte2mb:function(a,b){return(a/1048576).toFixed(b||2)+"MB"},byte2gb:function(a,b){return(a/1073741824).toFixed(b||2)+"GB"},byte2:function(a,b){var c=a/1024,g="KB";100<c&&(c/=1024,g="MB");100<c&&(c/=1024,g="GB");return c.toFixed(b||2)+g}};window.jees=jees||{};jees.platform={isNative:function(){return cc.sys.isNative},isAndroid:function(){return cc.sys.os===cc.sys.OS_ANDROID},request:function(){return cc.loader.getXMLHttpRequest()},localStorage:function(){return cc.sys.localStorage}};window.jees=jees||{};jees.file={load:function(a,b,c){cc.loader.loadRes(a,function(a,l){a?(err("\u52a0\u8f7d\u6587\u4ef6\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(a)),c&&c(a)):b&&b(l)})},loadRemote:function(a,b,c){cc.loader.load(a,function(g,l){g?(err("\u52a0\u8f7d\u6587\u4ef6["+a+"]\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(g)),c&&c(g)):b&&b(l)})},files:function(a,b){},json:function(a,b,c){cc.loader.loadRes(a,function(g,l){g?(err("\u52a0\u8f7d\u6587\u4ef6["+a+"]\u53d1\u751f\u9519\u8bef\uff1a"+JSON.stringify(g)),c&&c(g)):b&&b(l.json)})},file:function(a){return cc.url.raw(a)},text:function(a){return jsb&&jsb.fileUtils&&jsb.fileUtils.getStringFromFile(a)},remove:function(a){log("\u5220\u9664\u6587\u4ef6: "+a);jsb&&jsb.fileUtils&&jsb.fileUtils.isFileExist(a)&&jsb.fileUtils.removeFile(a)},removeDir:function(a){log("\u5220\u9664\u76ee\u5f55: "+a);jsb&&jsb.fileUtils&&jsb.fileUtils.isDirectoryExist(a)&&jsb.fileUtils.removeDirectory(a)}};window.jees=jees||{};jees.game={_mods:["Start","Update","Game"],_modIdx:1,_frame:[],init:function(a){this._inited||(this._inited=!0,jees.data.init(),jees.http.init(),jees.socket.init())},enter:function(){var a=this._mods[this._modIdx];this._modIdx>=this._mods.length||(this._modIdx++,cc.director.loadScene(a))},leave:function(){},frame:function(a){a&&this._frame.push(a)},update:function(a){(a=this._frame.shift())&&a()}};window.jees=jees||{};jees.view={init:function(a){this._inited||(this._inited=!0)}};jees.view.Comp=cc.Class({"extends":cc.Component,onLoad:function(){this._ex_load&&this._ex_load()},start:function(){this._ex_start&&this._ex_start()},update:function(a){this._ex_update&&this._ex_update(a)},onEnable:function(){this._ex_enable&&this._ex_enable()},onDisable:function(){this._ex_disable&&this._ex_disable()},onDestroy:function(){this._ex_destroy&&this._ex_destroy()},bind:function(a,b){jees.notifire.bind(this,a,b)},unbind:function(a){jees.notifire.unbind(this,a)},notify:function(a,b,c,g,l,m){this._ex_notify&&this._ex_notify(a,b,c,g,l,m)}});jees.view.Fire=cc.Class({"extends":jees.view.Comp,properties:{nodeHead:cc.Node,nodeBody:cc.Node,viewBody:cc.Prefab},onLoad:function(){jees.game.init();jees.view.init(this);if(this.nodeBody&&this.viewBody){var a=cc.instantiate(this.viewBody);this.nodeBody.addChild(a)}this._ex_load&&this._ex_load()}});jees.view.Body=cc.Class({"extends":jees.view.Comp});window.jees=jees||{};window.HotUpdateEvent=function(a){this._code=a||jees.hotUpdate.UPDATE_FAILED;this.getEventCode=function(){return this._code}};jees.hotUpdate={ANDROID_MAX_CONNECT:2,_status:0,STATUS_NONE:0,STATUS_UPDATING:1,STATUS_FINISH:2,STATUS_ISNEW:3,STATUS_FAILED:-1,ERROR_NO_LOCAL_MANIFEST:0,ERROR_DOWNLOAD_MANIFEST:1,ERROR_PARSE_MANIFEST:2,NEW_VERSION_FOUND:3,ALREADY_UP_TO_DATE:4,UPDATE_PROGRESSION:5,ASSET_UPDATED:6,ERROR_UPDATING:7,UPDATE_FINISHED:8,UPDATE_FAILED:9,ERROR_DECOMPRESS:10,_current_version:"1.0.0",_remote_manifest:"http://127.0.0.1/ccc/project.manifest",_update_dir:"remote-assets",_manifest_name:"project.manifest",_manifest_file:null,_compare:function(a,b){log("\u6bd4\u8f83\u7248\u672c: "+a+", \u8fdc\u7a0b\u7248\u672c: "+b);for(var c=a.split("."),g=b.split("."),l=0;l<c.length;++l){var m=parseInt(c[l]),p=parseInt(g[l]||0);if(m!==p)return m-p}return g.length>c.length?-1:0},_verify:function(a,b){b.compressed||md5(jsb.fileUtils.getDataFromFile(a));return!0},_callback:function(a){var b=a.getEventCode();log("\u66f4\u65b0\u72b6\u6001: "+this.code(b));switch(b){case this.UPDATE_PROGRESSION:case this.ASSET_UPDATED:break;case this.NEW_VERSION_FOUND:this._status==this.STATUS_NONE&&(this._status=this.STATUS_UPDATING,this._am.update());break;case this.ALREADY_UP_TO_DATE:this._status==this.STATUS_NONE&&(this._status=this.STATUS_ISNEW,this._am.setEventCallback(null));break;case this.UPDATE_FINISHED:this._status==this.STATUS_UPDATING&&(this._status=this.STATUS_FINISH,this._save(),this._am.setEventCallback(null));break;default:this._status=this.STATUS_FAILED;this._am.setEventCallback(null);return}this._handler&&this._handler(this._status,a)},_save:function(){log("\u66f4\u65b0\u5b8c\u6210, \u4fdd\u5b58\u66f4\u65b0\u4fe1\u606f.");var a=jsb.fileUtils.getSearchPaths(),b=this._am.getLocalManifest().getSearchPaths();log("\u65b0\u7684\u641c\u7d22\u8def\u5f84: "+JSON.stringify(b));Array.prototype.unshift(a,b);a=JSON.stringify(a);log("\u6700\u7ec8\u641c\u7d22\u8def\u5f84: "+a);jees.data.set("HotUpdateSearchPaths",a);jsb.fileUtils.setSearchPaths(a)},code:function(a){var b="\u72b6\u6001\u7801["+a+"]: ";switch(a){case this.ERROR_NO_LOCAL_MANIFEST:b="\u672c\u5730Manifest\u6587\u4ef6\u6ca1\u6709\u627e\u5230!";break;case this.ERROR_DOWNLOAD_MANIFEST:b="\u8fdc\u7a0bManifest\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25!";break;case this.ERROR_PARSE_MANIFEST:b="\u8fdc\u7a0bManifest\u6587\u4ef6\u89e3\u6790\u5931\u8d25!";break;case this.NEW_VERSION_FOUND:b="\u53d1\u73b0\u65b0\u7684\u7248\u672c.";break;case this.ALREADY_UP_TO_DATE:b="\u5f53\u524d\u5df2\u7ecf\u662f\u6700\u65b0\u7248\u672c\u4e86.";break;case this.UPDATE_PROGRESSION:b="\u6b63\u5728\u66f4\u65b0\u4e2d...";break;case this.UPDATE_FINISHED:b="\u66f4\u65b0\u6210\u529f.";break;case this.UPDATE_FAILED:b="\u66f4\u65b0\u5931\u8d25!";break;case this.ERROR_UPDATING:b="\u66f4\u65b0\u53d1\u751f\u9519\u8bef!";break;case this.ERROR_DECOMPRESS:b="\u89e3\u538b\u53d1\u751f\u9519\u8bef!";break;case this.ASSET_UPDATED:b="\u8d44\u6e90\u5df2\u66f4\u65b0."}return b},version:function(){return this._current_version},bind:function(a){this._handler=a||null},check:function(a){var b=this;a&&(this._remote_manifest=a);log("\u68c0\u67e5\u66f4\u65b0...");if(jees.platform.isNative()){this._update_dir=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+this._update_dir;this._manifest_file=this._update_dir+"/"+this._manifest_name;a="";if(jsb.fileUtils.isFileExist(this._manifest_file))log("\u4f7f\u7528\u672c\u5730\u5df2\u5b58\u50a8Manifest: "+this._manifest_file);else{log("\u7b2c\u4e00\u6b21\u66f4\u65b0...");log("\u4f7f\u7528Manifest: "+this._remote_manifest);if(this._remote_manifest.startsWith("http")){jees.http.get(this._remote_manifest,function(a){log("\u670d\u52a1\u5668\u8fd4\u56de2: ",a);a=JSON.parse(a);a.version=b._current_version;a.assets=[];a.searchPaths=[];a=JSON.stringify(a);log("Manifest\u5185\u5bb9: "+a);b._manifest_file=new jsb.Manifest(a,b._update_dir);jees.game.frame(function(){b.starting()})});return}this._manifest_file=jees.file.file(this._remote_manifest)}a=jees.file.text(this._manifest_file);log("Manifest\u5185\u5bb9: "+a);this._current_version=JSON.parse(a).version;this.starting()}else log("\u65e0\u6cd5\u4f7f\u7528\u5728\u7ebf\u66f4\u65b0"),this._handler&&this._handler(this.STATUS_FAILED,new HotUpdateEvent)},starting:function(){log("\u5f00\u59cb\u66f4\u65b0...");this._am=new jsb.AssetsManager(this._manifest_file,this._update_dir);this._am.setVerifyCallback(this._verify);this._am.setVersionCompareHandle(this._compare);this._am.setEventCallback(this._callback.bind(this));jees.platform.isAndroid()&&(this._am.setMaxConcurrentTask(this.ANDROID_MAX_CONNECT),log("\u8bbe\u7f6e\u5b89\u5353\u8bbe\u5907\u540c\u65f6\u6700\u5927\u4e0b\u8f7d\u6570\uff1a"+this.ANDROID_MAX_CONNECT));this._am.getState()===jsb.AssetsManager.State.UNINITED&&this._am.loadLocalManifest(this._manifest_file,this._update_dir);var a=this._am.getLocalManifest(),b=a&&a.isLoaded();b?this._am.checkUpdate():(log("Manifest\u6587\u4ef6\u65e0\u6548\u6216\u8005\u52a0\u8f7d\u5931\u8d25."+JSON.stringify(a)+"-\x3e"+b),this._handler&&this._handler(this.STATUS_FAILED,new HotUpdateEvent(this.ERROR_DOWNLOAD_MANIFEST)))},retry:function(){log("\u91cd\u65b0\u4e0b\u8f7d\u8d44\u6e90...");this._am.downloadFailedAssets()}};